{% extends "base.html" %}

{% block title %}Profile - SIGMS{% endblock %}

{% block nav_links %}
<!-- {% if current_user.user_type == 'student' %}
<li><a href="{{ url_for('student_dashboard') }}">Dashboard</a></li>
{% elif current_user.user_type == 'admin' %}
<li><a href="{{ url_for('admin_dashboard') }}">Dashboard</a></li>
{% else %}
<li><a href="{{ url_for('superadmin_dashboard') }}">Dashboard</a></li>
{% endif %}
<li><a href="{{ url_for('profile') }}" class="active">Profile</a></li> -->
{% endblock %}

{% block sidebar_links %}
{% if current_user.user_type == 'student' %}
<li><a href="{{ url_for('student_dashboard') }}" class="sidebar-link"><i class="fas fa-home"></i> Dashboard</a></li>
{% elif current_user.user_type == 'admin' %}
<li><a href="{{ url_for('admin_dashboard') }}" class="sidebar-link"><i class="fas fa-home"></i> Dashboard</a></li>
{% else %}
<li><a href="{{ url_for('superadmin_dashboard') }}" class="sidebar-link"><i class="fas fa-home"></i> Dashboard</a></li>
{% endif %}
<li><a href="{{ url_for('profile') }}" class="sidebar-link active"><i class="fas fa-user"></i> My Profile</a></li>
{% endblock %}

{% block content %}
<div class="page active">
    <h2 class="page-title">My Profile</h2>
    
    <div class="card">
        <div class="card-header">Profile Information</div>
        <div class="card-body">
            <form method="POST" action="{{ url_for('profile') }}">
                <div class="form-row">
                    {% if current_user.user_type == 'student' %}
                    <div class="form-group">
                        <label for="studentNumber">Student Number</label>
                        <input type="text" id="studentNumber" name="studentNumber" class="form-control" value="{{ current_user.student_number }}" readonly>
                    </div>
                    {% endif %}
                    <div class="form-group">
                        <label for="name">Full Name</label>
                        <input type="text" id="name" name="name" class="form-control" value="{{ current_user.name }}" required>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="email">Email</label>
                    <input type="email" id="email" name="email" class="form-control" value="{{ current_user.email }}" required>
                </div>

                {% if current_user.user_type == 'student' %}
                <div class="form-row">
                    <div class="form-group">
                        <label for="year">Year Level</label>
                        <select id="year" name="year" class="form-control" required>
                            <option value="1" {% if current_user.year == 1 %}selected{% endif %}>1st Year</option>
                            <option value="2" {% if current_user.year == 2 %}selected{% endif %}>2nd Year</option>
                            <option value="3" {% if current_user.year == 3 %}selected{% endif %}>3rd Year</option>
                            <option value="4" {% if current_user.year == 4 %}selected{% endif %}>4th Year</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="section">Section</label>
                        <select id="section" name="section" class="form-control" required>
                            <option value="A" {% if current_user.section == 'A' %}selected{% endif %}>A</option>
                            <option value="B" {% if current_user.section == 'B' %}selected{% endif %}>B</option>
                            <option value="C" {% if current_user.section == 'C' %}selected{% endif %}>C</option>
                            <option value="D" {% if current_user.section == 'D' %}selected{% endif %}>D</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group" id="majorGroup">
                        <label for="major">Major</label>
                        <select id="major" name="major" class="form-control">
                            <option value="">Select Major</option>
                            <option value="WMAD" {% if current_user.major == 'WMAD' %}selected{% endif %}>WMAD</option>
                            <option value="NETAD" {% if current_user.major == 'NETAD' %}selected{% endif %}>NETAD</option>
                            <option value="AMG" {% if current_user.major == 'AMG' %}selected{% endif %}>AMG</option>
                            <option value="SMP" {% if current_user.major == 'SMP' %}selected{% endif %}>SMP</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="sig">Special Interest Group</label>
                        <select id="sig" name="sig" class="form-control" required>
                            <option value="CodEx" {% if current_user.sig == 'CodEx' %}selected{% endif %}>CodEx</option>
                            <option value="Netac" {% if current_user.sig == 'Netac' %}selected{% endif %}>Netac</option>
                            <option value="Source Code" {% if current_user.sig == 'Source Code' %}selected{% endif %}>Source Code</option>
                            <option value="Robotix" {% if current_user.sig == 'Robotix' %}selected{% endif %}>Robotix</option>
                            <option value="Graphicos" {% if current_user.sig == 'Graphicos' %}selected{% endif %}>Graphicos</option>
                        </select>
                    </div>
                </div>
                {% endif %}

                <button type="submit" class="btn">Update Profile</button>
            </form>
        </div>
    </div>

    <div class="card">
        <div class="card-header">Change Password</div>
        <div class="card-body">
            <form method="POST" action="{{ url_for('change_password') }}">
                <div class="form-group">
                    <label for="currentPassword">Current Password</label>
                    <input type="password" id="currentPassword" name="currentPassword" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="newPassword">New Password</label>
                    <input type="password" id="newPassword" name="newPassword" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="confirmPassword">Confirm New Password</label>
                    <input type="password" id="confirmPassword" name="confirmPassword" class="form-control" required>
                </div>
                <button type="submit" class="btn">Change Password</button>
            </form>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', function() {
   
    const yearSelect = document.getElementById('year');
    const majorGroup = document.getElementById('majorGroup');
    
    if (yearSelect && majorGroup) {
        function toggleMajorField() {
            if (yearSelect.value === '3' || yearSelect.value === '4') {
                majorGroup.style.display = 'block';
            } else {
                majorGroup.style.display = 'none';
            }
        }
        
        yearSelect.addEventListener('change', toggleMajorField);
        toggleMajorField();
    }
});
</script>
{% endblock %}